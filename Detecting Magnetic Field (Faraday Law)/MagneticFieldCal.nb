(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15857,        447]
NotebookOptionsPosition[     14777,        405]
NotebookOutlinePosition[     15131,        421]
CellTagsIndexPosition[     15088,        418]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Mu]", "=", 
   RowBox[{"4", "*", "\[Pi]", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "7"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{"28.2", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "2"}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6546543108353033`*^9, 3.654654340341181*^9}, {
   3.6546545856365128`*^9, 3.6546545883893147`*^9}, {3.6546547941921463`*^9, 
   3.654654820152232*^9}, 3.654654883352125*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"VertB", "[", 
      RowBox[{"r_", ",", "i_"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{"\[Mu]", "*", 
        RowBox[{"i", "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "\[Pi]"}], ")"}]}]}], ")"}], "*", " ", 
      RowBox[{"Integrate", "[", " ", 
       RowBox[{
        RowBox[{"r", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "^", "2"}], "+", 
             RowBox[{"s", "^", "2"}]}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"3", "/", "2"}], ")"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", 
          RowBox[{"2", "/", "L"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HorzB", "[", 
      RowBox[{"r_", ",", "i_"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{"\[Mu]", "*", 
        RowBox[{"i", "/", 
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]"}], ")"}]}]}], ")"}], "*", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "+", "r"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"l", "+", "r"}], ")"}], "^", "2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"L", "/", "2"}], ")"}], "^", "2"}]}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"3", "/", "2"}], ")"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "0", ",", "L"}], "}"}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.654654270565826*^9, 3.6546543096781187`*^9}, {
  3.6546545584711246`*^9, 3.6546545590883093`*^9}, {3.6546546039445763`*^9, 
  3.654654656034254*^9}, {3.654654859983788*^9, 3.654654885690535*^9}, {
  3.6546553459480867`*^9, 3.654655349870481*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SumB", "[", 
    RowBox[{"r_", ",", "i_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"VertB", "[", 
     RowBox[{"r", ",", "i"}], "]"}], "+", 
    RowBox[{"2", "*", 
     RowBox[{"HorzB", "[", 
      RowBox[{"r", ",", "i"}], "]"}]}], "-", 
    RowBox[{"VertB", "[", 
     RowBox[{
      RowBox[{"r", "+", "L"}], ",", "i"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.654654886921918*^9, 3.654654966286932*^9}, 
   3.65465511302172*^9, {3.654655303151675*^9, 3.654655303361722*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VertBT", "[", 
    RowBox[{"r_", ",", "i_"}], "]"}], " ", "=", " ", 
   RowBox[{"\[Mu]", " ", 
    RowBox[{"i", " ", "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "\[Pi]", " ", "r"}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.654826324496416*^9, 3.654826333355892*^9}, {
  3.654826371086267*^9, 3.654826411139324*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Expdata", "[", "1", "]"}], " ", "=", " ", 
  RowBox[{"Import", "[", 
   RowBox[{
   "\"\</Users/kwonminjae/Desktop/elecmag/exp1-2.csv\>\"", ",", 
    "\"\<Data\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6548225481308413`*^9, 3.654822569696918*^9}, {
  3.654822736638741*^9, 3.654822742561647*^9}, {3.654823293502515*^9, 
  3.6548232940958967`*^9}, {3.654823911925152*^9, 3.654823914635223*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"r\"\>", ",", "\<\"1/r\"\>", ",", "\<\"Eac (mV)\"\>", 
     ",", "\<\"Bac\"\>", ",", "\<\"Bac.Theory\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "20.5`", ",", "0.0487804878048781`", ",", "84.9`", ",", "0.0000367`", ",",
      "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "25.5`", ",", "0.0392156862745098`", ",", "55.3`", ",", "0.0000239`", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "30.5`", ",", "0.0327868852459016`", ",", "39.8`", ",", "0.0000172`", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "35.5`", ",", "0.028169014084507`", ",", "30.3`", ",", "0.0000131`", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "40.5`", ",", "0.0246913580246914`", ",", "24.2`", ",", "0.0000105`", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "45.5`", ",", "0.021978021978022`", ",", "19.8`", ",", "8.56`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "50.5`", ",", "0.0198019801980198`", ",", "16.7`", ",", "7.22`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "55.5`", ",", "0.018018018018018`", ",", "14.2`", ",", "6.14`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "60.5`", ",", "0.0165289256198347`", ",", "12.3`", ",", "5.32`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "65.5`", ",", "0.0152671755725191`", ",", "10.7`", ",", "4.63`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "70.5`", ",", "0.0141843971631206`", ",", "9.4`", ",", "4.06`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "75.5`", ",", "0.0132450331125828`", ",", "8.3`", ",", "3.59`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "80.5`", ",", "0.0124223602484472`", ",", "7.4`", ",", "3.2`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "85.5`", ",", "0.0116959064327485`", ",", "6.6`", ",", "2.85`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "90.5`", ",", "0.0110497237569061`", ",", "6.`", ",", "2.59`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "95.5`", ",", "0.0104712041884817`", ",", "5.4`", ",", "2.33`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "100.5`", ",", "0.00995024875621891`", ",", "4.9`", ",", "2.12`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "105.5`", ",", "0.00947867298578199`", ",", "4.5`", ",", "1.95`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "110.5`", ",", "0.00904977375565611`", ",", "4.1`", ",", "1.77`*^-6", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "115.5`", ",", "0.00865800865800866`", ",", "3.7`", ",", "1.6`*^-6", 
     ",", "\<\"\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.654822571141871*^9, 3.654822743246285*^9, 
  3.654823294474551*^9, 3.6548239150754833`*^9, 3.654826252291341*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Expdata", "[", "1", "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6548225733666973`*^9, 3.654822593139543*^9}, {
  3.65482265767087*^9, 3.654822687138216*^9}, {3.654822749847068*^9, 
  3.654822776610639*^9}, {3.6548230733277407`*^9, 3.654823085023119*^9}, {
  3.654823256771936*^9, 3.654823325866537*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"r\"\>", ",", "20.5`", ",", "25.5`", ",", "30.5`", ",", "35.5`",
    ",", "40.5`", ",", "45.5`", ",", "50.5`", ",", "55.5`", ",", "60.5`", ",",
    "65.5`", ",", "70.5`", ",", "75.5`", ",", "80.5`", ",", "85.5`", ",", 
   "90.5`", ",", "95.5`", ",", "100.5`", ",", "105.5`", ",", "110.5`", ",", 
   "115.5`"}], "}"}]], "Output",
 CellChangeTimes->{{3.6548233160210037`*^9, 3.654823326594632*^9}, 
   3.6548236314889927`*^9, 3.654823918996296*^9, 3.654826263869117*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Caldata", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SumB", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Expdata", "[", "1", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "3"}], ")"}]}]}], ",", "2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"Expdata", "[", "1", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "-", "1"}]}], 
       "}"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6548236329702663`*^9, 3.65482378620457*^9}, {
  3.654823846274208*^9, 3.654823846493878*^9}, {3.654823927010139*^9, 
  3.654824010085438*^9}, {3.654824068532648*^9, 3.654824100174618*^9}, {
  3.654824145022357*^9, 3.654824149864023*^9}, {3.6548243461223497`*^9, 
  3.654824490963099*^9}, {3.6548245341277018`*^9, 3.6548245886530933`*^9}, {
  3.654824626472165*^9, 3.654824733344112*^9}, {3.65482489310052*^9, 
  3.654824926826263*^9}, {3.654824965664166*^9, 3.654824968467555*^9}, {
  3.6548257588276577`*^9, 3.6548258803260612`*^9}, {3.654825914557584*^9, 
  3.654825978937251*^9}, {3.6548260701841373`*^9, 3.654826070377226*^9}, {
  3.654826187312552*^9, 3.6548261906771717`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.000019799852292068445`", ",", "0.00001599574302306393`", ",", 
   "0.000013441889815214342`", ",", "0.000011608500151512131`", ",", 
   "0.000010227542213541803`", ",", "9.14892526713486`*^-6", ",", 
   "8.28211440903725`*^-6", ",", "7.569302366578208`*^-6", ",", 
   "6.971882499823132`*^-6", ",", "6.463115824291987`*^-6", ",", 
   "6.023917340776757`*^-6", ",", "5.640315945690302`*^-6", ",", 
   "5.301860550903692`*^-6", ",", "5.000585303938575`*^-6", ",", 
   "4.730317863613161`*^-6", ",", "4.486205141670206`*^-6", ",", 
   "4.264380874243896`*^-6", ",", "4.061728035502276`*^-6", ",", 
   "3.875706090815879`*^-6", ",", "3.7042234580420626`*^-6"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.654825937193376*^9, 3.654825943197255*^9}, {
   3.654825980100878*^9, 3.654825986687348*^9}, 3.6548260707556057`*^9, 
   3.654826265468197*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Caldata", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"VertBT", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Expdata", "[", "1", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "3"}], ")"}]}]}], ",", "2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"Expdata", "[", "1", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "-", "1"}]}], 
       "}"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6548236329702663`*^9, 3.65482378620457*^9}, {
  3.654823846274208*^9, 3.654823846493878*^9}, {3.654823927010139*^9, 
  3.654824010085438*^9}, {3.654824068532648*^9, 3.654824100174618*^9}, {
  3.654824145022357*^9, 3.654824149864023*^9}, {3.6548243461223497`*^9, 
  3.654824490963099*^9}, {3.6548245341277018`*^9, 3.6548245886530933`*^9}, {
  3.654824626472165*^9, 3.654824733344112*^9}, {3.65482489310052*^9, 
  3.654824926826263*^9}, {3.654824965664166*^9, 3.654824968467555*^9}, {
  3.6548257588276577`*^9, 3.6548258803260612`*^9}, {3.654825914557584*^9, 
  3.654825978937251*^9}, {3.6548260701841373`*^9, 3.654826070377226*^9}, {
  3.654826187312552*^9, 3.6548261906771717`*^9}, {3.654826434084255*^9, 
  3.654826437993846*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00001951219512195122`", ",", "0.000015686274509803918`", ",", 
   "0.000013114754098360653`", ",", "0.000011267605633802815`", ",", 
   "9.876543209876543`*^-6", ",", "8.79120879120879`*^-6", ",", 
   "7.92079207920792`*^-6", ",", "7.207207207207207`*^-6", ",", 
   "6.611570247933885`*^-6", ",", "6.106870229007633`*^-6", ",", 
   "5.673758865248226`*^-6", ",", "5.298013245033113`*^-6", ",", 
   "4.968944099378882`*^-6", ",", "4.678362573099414`*^-6", ",", 
   "4.4198895027624305`*^-6", ",", "4.1884816753926696`*^-6", ",", 
   "3.980099502487562`*^-6", ",", "3.791469194312796`*^-6", ",", 
   "3.6199095022624432`*^-6", ",", "3.463203463203463`*^-6"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6548264422525578`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\</Users/kwonminjae/Desktop/elecmag/Caldata1-2.csv\>\"", ",", "Caldata", 
   ",", "\"\<CSV\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.654823838578026*^9, 3.654823842541565*^9}, {
   3.6548254375825253`*^9, 3.654825528672676*^9}, {3.654825582753859*^9, 
   3.6548255847412777`*^9}, 3.654825615926361*^9, {3.654826080609713*^9, 
   3.65482608244425*^9}}],

Cell[BoxData["\<\"/Users/kwonminjae/Desktop/elecmag/Caldata1-2.csv\"\>"], \
"Output",
 CellChangeTimes->{{3.65482551143929*^9, 3.6548255291377068`*^9}, 
   3.6548255860712957`*^9, 3.654825616454362*^9, 3.6548260827740393`*^9, 
   3.6548262678078012`*^9, 3.654826444744711*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.654825533148129*^9, 3.654825534115067*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"Expdata", "[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.654826046007909*^9, 3.65482606123446*^9}}],

Cell[BoxData["21"], "Output",
 CellChangeTimes->{{3.6548260533066797`*^9, 3.654826061573827*^9}}]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{Automatic, 2}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 560, 15, 46, "Input"],
Cell[1121, 37, 2074, 61, 63, "Input"],
Cell[3198, 100, 542, 15, 28, "Input"],
Cell[3743, 117, 378, 10, 28, "Input"],
Cell[CellGroupData[{
Cell[4146, 131, 435, 9, 28, "Input"],
Cell[4584, 142, 3153, 87, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7774, 234, 399, 8, 28, "Input"],
Cell[8176, 244, 511, 8, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8724, 257, 1585, 36, 97, "Input"],
Cell[10312, 295, 889, 16, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11238, 316, 1636, 37, 97, "Input"],
Cell[12877, 355, 767, 14, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13681, 374, 411, 8, 28, "Input"],
Cell[14095, 384, 276, 4, 39, "Output"]
}, Open  ]],
Cell[14386, 391, 92, 1, 28, "Input"],
Cell[CellGroupData[{
Cell[14503, 396, 158, 3, 28, "Input"],
Cell[14664, 401, 97, 1, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
